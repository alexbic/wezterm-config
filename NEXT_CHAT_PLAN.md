# ДЕТАЛЬНЫЙ ПЛАН СЛЕДУЮЩЕГО ЧАТА: F9 ЛОКАЛИЗАЦИЯ

## ПРОБЛЕМА #1: НЕСООТВЕТСТВИЕ КЛЮЧЕЙ (Сообщения 1-8)
### Текущее состояние:
- locale-manager.lua использует: locale_cache_file, locale_files, locale_manager, locale_stats
- ru.lua содержит: locale_manager_title, locale_manager_description, locale_create_new
- Кэш en.lua: НЕ содержит locale_* ключи

### Действия:
1. Привести locale-manager.lua в соответствие с ru.lua ключами
2. Убрать хардкод os.getenv("WEZTERM_LANG"), использовать environment.locale.t
3. Исправить все несуществующие ключи на правильные

## ПРОБЛЕМА #2: НЕПОЛНЫЙ КЭШИРОВАНИЕ (Сообщения 9-15) 
### Причина:
- en.lua создался из неполной ru.lua (29 ключей вместо всех)
- Автоперевод пропустил locale_* ключи

### Действия:
1. Дополнить en.lua всеми locale_* ключами из ru.lua
2. Регенерировать кэш с полным набором ключей
3. Проверить что F9 ключи попали в кэш

## ПРОБЛЕМА #3: АРХИТЕКТУРНАЯ ИНТЕГРАЦИЯ (Сообщения 16-25)
### Задача:
- locale-manager.lua должен использовать новую архитектуру кэширования
- Убрать прямые обращения к globals.DEFAULT_LANGUAGE
- Интегрировать с utils/environment.lua функциями

### Действия:
1. Переписать get_language_status() для работы с кэшем
2. Интегрировать с env_utils.rebuild_locale_cache_file()
3. Тестировать переключение языков через F9

## ПРОБЛЕМА #4: ПОЛНОЕ ТЕСТИРОВАНИЕ (Сообщения 26-35)
### Workflow для тестирования:
1. F9 → показать текущий язык из кэша
2. F9 → переключить ru→en→ru
3. F9 → создать новую локаль (de)
4. F9 → регенерировать кэш

### Ожидаемый результат:
- Полная интеграция F9 с системой кэширования
- Работающее переключение языков
- Автосоздание новых локалей

## ДОПОЛНИТЕЛЬНЫЕ УЛУЧШЕНИЯ (если останется время):
- Защита автоперевода от порчи форматирования (%s→%S)
- Создание полной ru.lua с 100+ ключами
- Улучшение UI F9 интерфейса
